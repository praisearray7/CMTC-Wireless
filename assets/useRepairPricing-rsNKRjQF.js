import{r as C}from"./vendor-react-ttcv0AaH.js";import{P as D}from"./papaparse.min-BxIXmAg3.js";const w="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7ZZsn4Cvg3d3LsqdvuhjtWFOCKhVr-E3tBQ_GqW9hoQI4eSM6-UcAD_RmZ6M7XGn9w3b76CNcY2UL/pub?gid=1867337181&single=true&output=csv",R=()=>{const[d,h]=C.useState([]),[S,n]=C.useState(!0);return C.useEffect(()=>{const l="repair_pricing_data",s="repair_pricing_timestamp",p=localStorage.getItem(l),f=localStorage.getItem(s);if(p&&f&&Date.now()-parseInt(f,10)<3e5)try{const t=JSON.parse(p);h(t),n(!1);return}catch(t){console.error("Failed to parse cached data",t)}D.parse(w,{download:!0,header:!1,complete:o=>{const t=o.data;let c=-1;const i={};for(let e=0;e<t.length;e++){const r=t[e];if(r.includes("Device")&&r.includes("Sub-Type Price (USD)")){c=e,r.forEach((u,m)=>{u&&(i[u.trim()]=m)});break}}if(c===-1){console.error("Could not find header row in CSV"),n(!1);return}const a=t.slice(c+1).map(e=>{const r=u=>e[i[u]]?.trim()||"";return!r("Device")&&!r("Repair Type")?null:{Device:r("Device"),"Device Model":r("Device Model"),"Repair Type":r("Repair Type"),"Sub-Type Title":r("Sub-Type Title"),"Sub-Type Price (USD)":r("Sub-Type Price (USD)"),Warranty:r("Warranty")}}).filter(e=>e!==null);h(a),n(!1);try{localStorage.setItem(l,JSON.stringify(a)),localStorage.setItem(s,Date.now().toString())}catch(e){console.error("Failed to save to cache",e)}},error:o=>{console.error("Error parsing CSV:",o),n(!1)}})},[]),{loading:S,getPriceRange:(l,s,g)=>{if(S)return"Loading...";if(!d.length)return"Contact for Price";const p=s.toLowerCase().replace(/ /g,"-").replace("/","-");let o=d.filter(a=>a.Device?.toLowerCase()===l.toLowerCase()).filter(a=>{const e=a["Repair Type"]?.toLowerCase();return e===p||e===s.toLowerCase().replace(/ /g,"-")});if(g&&(o=o.filter(a=>a["Device Model"]?.toLowerCase().replace(/\s+/g,"")===g.toLowerCase().replace(/\s+/g,""))),o.length===0)return"Contact for Price";const t=[];if(o.forEach(a=>{const e=a["Sub-Type Price (USD)"];if(e){const r=parseFloat(e.replace(/[^0-9.]/g,""));!isNaN(r)&&r>0&&t.push(r)}}),t.length===0)return"Contact for Price";const c=Math.min(...t),i=Math.max(...t);return c===i?`$${c}`:`$${c} - $${i}`},rawData:d}};export{R as u};
